{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { timeToSimpleDate } from \"./timeDiffCalc\";\n\nfunction getMilliseconds(time) {\n  if (time instanceof Date) {\n    var now = new Date();\n    return Math.floor((time.getTime() - now.getTime()) / 1000);\n  }\n\n  var days = time.days,\n      hours = time.hours,\n      minutes = time.minutes,\n      seconds = time.seconds;\n  return (days || 0) * 24 * 60 * 60 + (hours || 0) * 60 * 60 + (minutes || 0) * 60 + (seconds || 0);\n}\n\nexport default function useTimer(endTime) {\n  _s();\n\n  var timer = React.useRef();\n  var initialRemaining = React.useRef(getMilliseconds(endTime));\n\n  var _React$useState = React.useState(getMilliseconds(endTime)),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      remainingSeconds = _React$useState2[0],\n      setRemainingSeconds = _React$useState2[1];\n\n  React.useEffect(function () {\n    if (initialRemaining.current === getMilliseconds(endTime)) {\n      return;\n    }\n\n    initialRemaining.current = getMilliseconds(endTime);\n  }, [endTime]);\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      finished = _React$useState4[0],\n      setFinished = _React$useState4[1];\n\n  var tick = React.useCallback(function () {\n    setRemainingSeconds(function (prevState) {\n      if (prevState === 0) {\n        setFinished(true);\n        return 0;\n      }\n\n      return prevState - 1;\n    });\n  }, []);\n  var start = React.useCallback(function () {\n    if (endTime instanceof Date) {\n      var restartTime = getMilliseconds(endTime);\n\n      if (restartTime < 0) {\n        return;\n      }\n\n      setRemainingSeconds(restartTime);\n    }\n\n    if (!timer.current) {\n      timer.current = setInterval(function () {\n        return tick();\n      }, 1000);\n    }\n  }, [endTime, tick]);\n  var reset = React.useCallback(function () {\n    if (endTime instanceof Date) {\n      return;\n    }\n\n    setRemainingSeconds(initialRemaining.current);\n  }, [endTime]);\n  var pause = React.useCallback(function () {\n    if (timer.current) {\n      clearInterval(timer.current);\n      timer.current = undefined;\n    }\n  }, []);\n  var stop = React.useCallback(function () {\n    pause();\n    setRemainingSeconds(0);\n  }, [pause]);\n  React.useEffect(function () {\n    if (finished) {\n      stop();\n    }\n  }, [finished, stop]);\n  return {\n    /**\n     * The remaining amount of count down timer.\n     */\n    remainingTime: timeToSimpleDate(remainingSeconds),\n\n    /**\n     * Stops the timer counting and resets the remaining timer to zero.\n     */\n    stop: stop,\n\n    /**\n     * Starts the timer (or resumes it if paused already).\n     */\n    start: start,\n\n    /**\n     * A boolean showing if counting reached to zero by counting.\n     */\n    finished: finished,\n\n    /**\n     * Resets the remaining values to their initial values, if the timer is used with constant count down amount (and\n     * no end date). Otherwise does nothing.\n     */\n    reset: reset,\n\n    /**\n     * Stops timer from counting, but not reset the values of counting.\n     */\n    pause: pause\n  };\n}\n\n_s(useTimer, \"B6HzxGirV67uokwKM9lai3ktzxQ=\");","map":{"version":3,"sources":["/home/null/Desktop/University/8th/مباحث ویژه/Project/Frontend/sheroganj/utils/useTimer.ts"],"names":["React","timeToSimpleDate","getMilliseconds","time","Date","now","Math","floor","getTime","days","hours","minutes","seconds","useTimer","endTime","timer","useRef","initialRemaining","useState","remainingSeconds","setRemainingSeconds","useEffect","current","finished","setFinished","tick","useCallback","prevState","start","restartTime","setInterval","reset","pause","clearInterval","undefined","stop","remainingTime"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,gBAAR,QAA+B,gBAA/B;;AASA,SAASC,eAAT,CAAyBC,IAAzB,EAAsD;AACpD,MAAIA,IAAI,YAAYC,IAApB,EAA0B;AACxB,QAAMC,GAAG,GAAG,IAAID,IAAJ,EAAZ;AACA,WAAOE,IAAI,CAACC,KAAL,CAAW,CAACJ,IAAI,CAACK,OAAL,KAAiBH,GAAG,CAACG,OAAJ,EAAlB,IAAmC,IAA9C,CAAP;AACD;;AAJmD,MAK7CC,IAL6C,GAKZN,IALY,CAK7CM,IAL6C;AAAA,MAKvCC,KALuC,GAKZP,IALY,CAKvCO,KALuC;AAAA,MAKhCC,OALgC,GAKZR,IALY,CAKhCQ,OALgC;AAAA,MAKvBC,OALuB,GAKZT,IALY,CAKvBS,OALuB;AAMpD,SAAO,CAACH,IAAI,IAAI,CAAT,IAAc,EAAd,GAAmB,EAAnB,GAAwB,EAAxB,GAA6B,CAACC,KAAK,IAAI,CAAV,IAAe,EAAf,GAAoB,EAAjD,GAAsD,CAACC,OAAO,IAAI,CAAZ,IAAiB,EAAvE,IAA6EC,OAAO,IAAI,CAAxF,CAAP;AACD;;AAED,eAAe,SAASC,QAAT,CAAkBC,OAAlB,EAAkD;AAAA;;AAC/D,MAAMC,KAAK,GAAGf,KAAK,CAACgB,MAAN,EAAd;AACA,MAAMC,gBAAgB,GAAGjB,KAAK,CAACgB,MAAN,CAAad,eAAe,CAACY,OAAD,CAA5B,CAAzB;;AAF+D,wBAGfd,KAAK,CAACkB,QAAN,CAAehB,eAAe,CAACY,OAAD,CAA9B,CAHe;AAAA;AAAA,MAGxDK,gBAHwD;AAAA,MAGtCC,mBAHsC;;AAI/DpB,EAAAA,KAAK,CAACqB,SAAN,CAAgB,YAAM;AACpB,QAAIJ,gBAAgB,CAACK,OAAjB,KAA6BpB,eAAe,CAACY,OAAD,CAAhD,EAA2D;AACzD;AACD;;AACDG,IAAAA,gBAAgB,CAACK,OAAjB,GAA2BpB,eAAe,CAACY,OAAD,CAA1C;AACD,GALD,EAKG,CAACA,OAAD,CALH;;AAJ+D,yBAU/Bd,KAAK,CAACkB,QAAN,CAAe,KAAf,CAV+B;AAAA;AAAA,MAUxDK,QAVwD;AAAA,MAU9CC,WAV8C;;AAY/D,MAAMC,IAAI,GAAGzB,KAAK,CAAC0B,WAAN,CAAkB,YAAM;AACnCN,IAAAA,mBAAmB,CAAC,UAACO,SAAD,EAAe;AACjC,UAAIA,SAAS,KAAK,CAAlB,EAAqB;AACnBH,QAAAA,WAAW,CAAC,IAAD,CAAX;AACA,eAAO,CAAP;AACD;;AACD,aAAOG,SAAS,GAAG,CAAnB;AACD,KANkB,CAAnB;AAOD,GARY,EAQV,EARU,CAAb;AAUA,MAAMC,KAAK,GAAG5B,KAAK,CAAC0B,WAAN,CAAkB,YAAM;AACpC,QAAIZ,OAAO,YAAYV,IAAvB,EAA6B;AAC3B,UAAMyB,WAAW,GAAG3B,eAAe,CAACY,OAAD,CAAnC;;AACA,UAAIe,WAAW,GAAG,CAAlB,EAAqB;AACnB;AACD;;AACDT,MAAAA,mBAAmB,CAACS,WAAD,CAAnB;AACD;;AACD,QAAI,CAACd,KAAK,CAACO,OAAX,EAAoB;AAClBP,MAAAA,KAAK,CAACO,OAAN,GAAgBQ,WAAW,CAAC;AAAA,eAAML,IAAI,EAAV;AAAA,OAAD,EAAe,IAAf,CAA3B;AACD;AACF,GAXa,EAWX,CAACX,OAAD,EAAUW,IAAV,CAXW,CAAd;AAaA,MAAMM,KAAK,GAAG/B,KAAK,CAAC0B,WAAN,CAAkB,YAAM;AACpC,QAAIZ,OAAO,YAAYV,IAAvB,EAA6B;AAC3B;AACD;;AACDgB,IAAAA,mBAAmB,CAACH,gBAAgB,CAACK,OAAlB,CAAnB;AACD,GALa,EAKX,CAACR,OAAD,CALW,CAAd;AAOA,MAAMkB,KAAK,GAAGhC,KAAK,CAAC0B,WAAN,CAAkB,YAAM;AACpC,QAAIX,KAAK,CAACO,OAAV,EAAmB;AACjBW,MAAAA,aAAa,CAAClB,KAAK,CAACO,OAAP,CAAb;AACAP,MAAAA,KAAK,CAACO,OAAN,GAAgBY,SAAhB;AACD;AACF,GALa,EAKX,EALW,CAAd;AAOA,MAAMC,IAAI,GAAGnC,KAAK,CAAC0B,WAAN,CAAkB,YAAM;AACnCM,IAAAA,KAAK;AACLZ,IAAAA,mBAAmB,CAAC,CAAD,CAAnB;AACD,GAHY,EAGV,CAACY,KAAD,CAHU,CAAb;AAKAhC,EAAAA,KAAK,CAACqB,SAAN,CAAgB,YAAM;AACpB,QAAIE,QAAJ,EAAc;AACZY,MAAAA,IAAI;AACL;AACF,GAJD,EAIG,CAACZ,QAAD,EAAWY,IAAX,CAJH;AAMA,SAAO;AACL;AACJ;AACA;AACIC,IAAAA,aAAa,EAAEnC,gBAAgB,CAACkB,gBAAD,CAJ1B;;AAKL;AACJ;AACA;AACIgB,IAAAA,IAAI,EAAJA,IARK;;AASL;AACJ;AACA;AACIP,IAAAA,KAAK,EAALA,KAZK;;AAaL;AACJ;AACA;AACIL,IAAAA,QAAQ,EAARA,QAhBK;;AAiBL;AACJ;AACA;AACA;AACIQ,IAAAA,KAAK,EAALA,KArBK;;AAsBL;AACJ;AACA;AACIC,IAAAA,KAAK,EAALA;AAzBK,GAAP;AA2BD;;GAvFuBnB,Q","sourcesContent":["import React from \"react\";\nimport {timeToSimpleDate} from \"./timeDiffCalc\";\n\nexport type SimpleDateTime = {\n  days?: number;\n  hours?: number;\n  minutes?: number;\n  seconds?: number;\n};\n\nfunction getMilliseconds(time: Date | SimpleDateTime) {\n  if (time instanceof Date) {\n    const now = new Date();\n    return Math.floor((time.getTime() - now.getTime()) / 1000);\n  }\n  const {days, hours, minutes, seconds} = time;\n  return (days || 0) * 24 * 60 * 60 + (hours || 0) * 60 * 60 + (minutes || 0) * 60 + (seconds || 0);\n}\n\nexport default function useTimer(endTime: Date | SimpleDateTime) {\n  const timer = React.useRef<NodeJS.Timeout | undefined>();\n  const initialRemaining = React.useRef(getMilliseconds(endTime));\n  const [remainingSeconds, setRemainingSeconds] = React.useState(getMilliseconds(endTime));\n  React.useEffect(() => {\n    if (initialRemaining.current === getMilliseconds(endTime)) {\n      return;\n    }\n    initialRemaining.current = getMilliseconds(endTime);\n  }, [endTime]);\n  const [finished, setFinished] = React.useState(false);\n\n  const tick = React.useCallback(() => {\n    setRemainingSeconds((prevState) => {\n      if (prevState === 0) {\n        setFinished(true);\n        return 0;\n      }\n      return prevState - 1;\n    });\n  }, []);\n\n  const start = React.useCallback(() => {\n    if (endTime instanceof Date) {\n      const restartTime = getMilliseconds(endTime);\n      if (restartTime < 0) {\n        return;\n      }\n      setRemainingSeconds(restartTime);\n    }\n    if (!timer.current) {\n      timer.current = setInterval(() => tick(), 1000);\n    }\n  }, [endTime, tick]);\n\n  const reset = React.useCallback(() => {\n    if (endTime instanceof Date) {\n      return;\n    }\n    setRemainingSeconds(initialRemaining.current);\n  }, [endTime]);\n\n  const pause = React.useCallback(() => {\n    if (timer.current) {\n      clearInterval(timer.current);\n      timer.current = undefined;\n    }\n  }, []);\n\n  const stop = React.useCallback(() => {\n    pause();\n    setRemainingSeconds(0);\n  }, [pause]);\n\n  React.useEffect(() => {\n    if (finished) {\n      stop();\n    }\n  }, [finished, stop]);\n\n  return {\n    /**\n     * The remaining amount of count down timer.\n     */\n    remainingTime: timeToSimpleDate(remainingSeconds),\n    /**\n     * Stops the timer counting and resets the remaining timer to zero.\n     */\n    stop,\n    /**\n     * Starts the timer (or resumes it if paused already).\n     */\n    start,\n    /**\n     * A boolean showing if counting reached to zero by counting.\n     */\n    finished,\n    /**\n     * Resets the remaining values to their initial values, if the timer is used with constant count down amount (and\n     * no end date). Otherwise does nothing.\n     */\n    reset,\n    /**\n     * Stops timer from counting, but not reset the values of counting.\n     */\n    pause,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}